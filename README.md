# Energy Consumption Forecasting

This project provides a comprehensive analysis and forecasting pipeline for the Kaggle Hourly Energy Consumption dataset. It explores the data, builds several predictive models, and culminates in a state-of-the-art Temporal Fusion Transformer (TFT) for multi-horizon forecasting.

## Features

- **In-depth EDA**: Statistical analysis, correlation studies, and visualization of temporal patterns (hourly, daily, seasonal).
- **Multiple Models**: Includes Linear Regression, Ridge, Lasso, Random Forest, XGBoost, LightGBM, and CatBoost.
- **Temporal Fusion Transformer**: An interpretable deep learning model for multi-horizon forecasting with uncertainty quantification.
- **Production-Ready Scripts**: Standalone scripts for automated training and prediction with the TFT model.
- **Comprehensive Analysis**: A detailed report on the findings is available in [`Analysis.md`](Analysis.md).

## Repository Structure

```
EnergyConsumption/
├── notebooks/
│   ├── exploration.ipynb       # Main analysis notebook (complete pipeline)
│   └── model_comparison.ipynb  # Notebook for comparing models
├── scripts/
│   ├── train_tft.py            # Standalone TFT training/testing script
│   ├── predict_tft.py          # TFT prediction and visualization script
│   └── experimental/
│       ├── (scripts for DeepAR, Informer, N-BEATS)
├── tests/
│   ├── test_tft_compatibility.py
│   └── test_tft_working.py
├── Analysis.md                 # Detailed report of the analysis and findings
├── TFT_GUIDE.md                # Complete guide to the TFT scripts
├── README.md                   # This file
├── requirements.txt            # Project dependencies
├── pyproject.toml              # Project configuration
├── LICENSE
└── .gitignore
```

*Generated directories such as `checkpoints/`, `lightning_logs/`, and `catboost_info/` are not included in this list.*

## Getting Started

### Prerequisites

- Python 3.9+
- Kaggle API token (for downloading the dataset)

### Installation

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd EnergyConsumption
    ```

2.  **Set up a virtual environment:**
    ```bash
    python -m venv .venv
    ```

3.  **Activate the environment:**
    -   Windows: `.venv\Scripts\activate`
    -   macOS/Linux: `source .venv/bin/activate`

4.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

## Usage

### 1. Data Preparation

The `composite_energy_data.csv` file required for the analysis is generated by running the initial cells of the `notebooks/exploration.ipynb` notebook. This step downloads the data from Kaggle and processes it.

### 2. Exploration and Modeling (Notebooks)

For a detailed, step-by-step exploration of the data and models, use the Jupyter notebooks:

```bash
jupyter notebook notebooks/exploration.ipynb
```

### 3. Training and Prediction (Scripts)

For automated training and prediction with the Temporal Fusion Transformer model, use the provided scripts.

**Train a new TFT model:**
```bash
python scripts/train_tft.py --mode train_test --epochs 50
```
*(See `TFT_GUIDE.md` for more training options)*

**Make predictions with a trained model:**
```bash
python scripts/predict_tft.py --checkpoint checkpoints/<your-model.ckpt>
```

**Monitor training with TensorBoard:**
```bash
tensorboard --logdir lightning_logs
```

## Analysis and Findings

A detailed report on the project's findings, including visualizations and model performance comparisons, is available in [`Analysis.md`](Analysis.md).

## Temporal Fusion Transformer (TFT)

For a deep dive into the TFT model, its architecture, and how to use the training and prediction scripts, please refer to the [`TFT_GUIDE.md`](TFT_GUIDE.md).

## Technology Stack

- **Core**: NumPy, Pandas, SciPy
- **Visualization**: Matplotlib, Seaborn
- **Machine Learning**: scikit-learn, XGBoost, LightGBM, CatBoost
- **Deep Learning**: PyTorch, PyTorch Lightning, PyTorch Forecasting
- **Development**: Jupyter, Kaggle API

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
